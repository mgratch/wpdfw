function gformAddStripeCouponsAction(r,e){e===parseInt(gfp_stripe_coupons_js_vars.form_id)&&jQuery("#gform_"+e+" #input_"+e+"_"+gfp_stripe_coupons_js_vars.coupon_field_id).change(function(){if(window.gformCalculateTotalPrice){var r=jQuery(".ginput_total_"+e);jQuery(r).before('<img id="gform_ajax_spinner_'+e+'"  class="gform_ajax_spinner" src="'+gfp_stripe_coupons_js_vars.spinner_url+'" alt="" />'),window.gformCalculateTotalPrice(e)}})}function gform_product_total(r,e){var _=gfp_stripe_coupons_js_vars.coupon_field_id;jQuery("#gform_"+r+" li#field_"+r+"_"+_).removeClass("gfield_error"),jQuery("#gform_"+r+" li#field_"+r+"_"+_+" div.validation_message").remove();var o=jQuery(".ginput_total_"+r),f=jQuery("#gform_"+r+" #input_"+r+"_"+_).val();if(gfp_stripe_coupon.length>0&&gfp_stripe_coupon===f&&gfp_stripe_percent_off>0)return e-=e*(gfp_stripe_percent_off/100),jQuery(o).prev("img.gform_ajax_spinner").remove(),e;if(gfp_stripe_coupon.length>0&&gfp_stripe_coupon===f&&gfp_stripe_amount_off>0){if(0===gf_global.gf_currency_config.decimals)var p=gfp_stripe_amount_off;else var p=gfp_stripe_amount_off/100;return e-=p,jQuery(o).prev("img.gform_ajax_spinner").remove(),e}return gfp_stripe_coupon.length>0&&0===f.length?(jQuery(o).prev("img.gform_ajax_spinner").remove(),e):(f.length>0&&jQuery.post(gfp_stripe_coupons_js_vars.ajaxurl,{action:"gfp_more_stripe_get_coupon",coupon:f,form:r},function(p){if(!0===p.success){if(gfp_stripe_coupon=f,gfp_stripe_percent_off=p.data.percent_off,gfp_stripe_percent_off>0)e-=e*(gfp_stripe_percent_off/100);else if(gfp_stripe_amount_off=p.data.amount_off,gfp_stripe_amount_off>0){if(0===gf_global.gf_currency_config.decimals)var i=gfp_stripe_amount_off;else var i=gfp_stripe_amount_off/100;e-=i}return o.length>0&&(o.next().val(e),jQuery(o).prev("img.gform_ajax_spinner").remove(),o.html(gformFormatMoney(e))),e}var t=p.data.error_message;return jQuery(o).prev("img.gform_ajax_spinner").remove(),jQuery("#gform_"+r+" #input_"+r+"_"+_).val(""),jQuery("#gform_"+r+" li#field_"+r+"_"+_).addClass("gfield_error"),jQuery("#gform_"+r+" li#field_"+r+"_"+_+" div.ginput_container").after("<div class='gfield_description validation_message'>"+t+"</div>"),gfp_stripe_coupon="",gfp_stripe_percent_off=0,gfp_stripe_amount_off=0,e}),e)}var gfp_stripe_coupon="",gfp_stripe_percent_off=0,gfp_stripe_amount_off=0;jQuery(document).ready(function(){jQuery(document).on("gform_post_render",gformAddStripeCouponsAction)});